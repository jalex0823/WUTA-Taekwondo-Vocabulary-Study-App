<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">

    <meta name="theme-color" content="#667eea">

    <title>My Words - WUTA Vocabulary</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="theme-arcade theme-screenshot page-my-words">
    <div class="container">
        <header class="terms-header" style="--belt-color: #ff9f1a">
            <div class="terms-brand" aria-hidden="true">
                <picture class="terms-brand-mascot">
                    <img
                        src="{{ url_for('static', filename='images/TVTA_Neal.png') }}"
                        alt=""
                        loading="eager"
                        onerror="this.onerror=null; this.src='{{ url_for('static', filename='images/branding/mascot.svg') }}';"
                    >
                </picture>
            </div>

            <a href="/" class="back-button">‚Üê Back to Main Menu</a>
            <h1>My Words</h1>
            <p class="term-counter">
                <span>{{ terms|length }}</span> saved
            </p>

            <div class="my-words-header-actions">
                {% if current_user %}
                    <span class="chip chip--muted">{{ current_user.username }}</span>
                    <a class="nav-button" href="{{ url_for('account') }}">Account</a>
                    <a class="nav-button" href="{{ url_for('logout') }}">Logout</a>
                {% else %}
                    <a class="nav-button" href="{{ url_for('login', next=request.path) }}">Login</a>
                    <a class="nav-button primary" href="{{ url_for('register', next=request.path) }}">Register</a>
                {% endif %}
                <a class="nav-button primary" href="/my-words/train">‚ñ∂Ô∏è Train My Words</a>
                <form method="post" action="/my-words/repair" style="display:inline; margin-left: 8px;">
                    <button class="nav-button" type="submit" onclick="return confirm('Repair missing/invalid Korean translations using auto-translate?');">üõ†Ô∏è Repair translations</button>
                </form>
            </div>
        </header>

        <div class="my-words-panel">
            {% if error %}
            <div class="my-words-alert my-words-alert--error" role="alert">{{ error }}</div>
            {% endif %}
            {% if notice %}
            <div class="my-words-alert my-words-alert--notice" role="status">{{ notice }}</div>
            {% endif %}

            <div class="my-words-grid">
                <section class="my-words-card" aria-label="Add a word">
                    <h2 class="my-words-title">Add a word</h2>
                    <form method="post" action="/my-words/add" class="my-words-form">
                        <label class="my-words-label" for="english">English</label>
                        <input id="english" name="english" type="text" autocomplete="off" placeholder="Front kick" value="{{ pref_english or '' }}" required>

                        <div class="my-words-row">
                            <div class="my-words-field">
                                <label class="my-words-label" for="category">Category (optional)</label>
                                <input id="category" name="category" type="text" autocomplete="off" placeholder="Kicks" value="{{ pref_category or '' }}">
                            </div>
                            <div class="my-words-field">
                                <label class="my-words-label" for="romanization">Romanization (optional)</label>
                                <input id="romanization" name="romanization" type="text" autocomplete="off" placeholder="Ap chagi" value="{{ pref_romanization or '' }}">
                            </div>
                        </div>

                        <label class="my-words-label" for="hangul">Korean (Hangul) (optional)</label>
                        <input id="hangul" name="hangul" type="text" autocomplete="off" placeholder="ÏïûÏ∞®Í∏∞">

                        <p class="my-words-hint">If blank, we‚Äôll try matching the built-in WUTA vocab first (then auto-translate only if enabled). Tip: don‚Äôt paste English here.</p>

                        <button class="nav-button primary" type="submit">‚ûï Add</button>
                    </form>
                </section>

                <section class="my-words-card" aria-label="Import words">
                    <h2 class="my-words-title">Import (bulk)</h2>
                    <form method="post" action="/my-words/import" class="my-words-form">
                        <label class="my-words-label" for="bulk_english">Paste one English word/phrase per line</label>
                        <textarea id="bulk_english" name="bulk_english" rows="7" placeholder="Front kick\nRoundhouse kick\nBlock"></textarea>

                        <label class="my-words-label" for="import_category">Category for imported words (optional)</label>
                        <input id="import_category" name="category" type="text" autocomplete="off" placeholder="User">

                        <button class="nav-button" type="submit">üì• Import</button>
                        <p class="my-words-hint">Tip: Import is capped at 50 lines per submit.</p>
                    </form>
                </section>
            </div>
        </div>

        <div class="my-words-panel">
            <h2 class="my-words-title">Saved words</h2>

            {% if terms|length == 0 %}
            <p class="my-words-empty">No words yet. Add your first one above.</p>
            {% else %}
            <div class="my-words-list" role="list">
                {% for t in terms %}
                <div class="my-words-item" role="listitem">
                    <div class="my-words-item__main">
                        <div class="my-words-item__hangul">{{ t.hangul }}</div>
                        <div class="my-words-item__english">{{ t.english }}</div>
                        <div class="my-words-item__meta">
                            {% if t.romanization %}<span class="chip">{{ t.romanization }}</span>{% endif %}
                            {% if t.category %}<span class="chip chip--muted">{{ t.category }}</span>{% endif %}
                        </div>
                    </div>
                    <form method="post" action="/my-words/delete/{{ t.id }}" class="my-words-item__actions" onsubmit="return confirm('Delete this word?');">
                        <button type="submit" class="nav-button nav-button--danger">Delete</button>
                    </form>
                </div>
                {% endfor %}
            </div>
            {% endif %}
        </div>

        <footer class="app-footer">
            <p>Practice makes perfect ‚Äî and custom words make it personal.</p>
        </footer>
    </div>
</body>
</html>
